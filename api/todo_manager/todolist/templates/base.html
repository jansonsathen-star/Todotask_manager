{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}{% endblock title %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <style>
      /* Gentle animated header gradient (slower, subtle) */
      @keyframes gradientShift {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }
      /* animated header gradient lives in a fixed background layer so content can scroll under it */
      .header-bg {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 72px; /* reduced to match navbar content */
        background: linear-gradient(90deg, #0f1724, #0b3a3a, #04203a);
        background-size: 200% 200%;
        animation: gradientShift 14s ease-in-out infinite;
        z-index: 0;
        pointer-events: none;
      }
      /* subtle page background: soft gradient with light texture */
      body {
        background: linear-gradient(180deg, #f8fafc 0%, #eef2f7 100%);
        background-attachment: fixed;
      }
      .navbar-brand img { height:40px; width:40px; object-fit:cover; border-radius:6px; transition: transform .18s ease; }
      .navbar-brand img:hover { transform: scale(1.03); }
      /* Ensure navbar links are visible over the animated header (Tailwind may override Bootstrap) */
      .navbar .nav-link { color: rgba(255,255,255,0.95) !important; font-weight:600; }
      .navbar .nav-link:hover, .navbar .nav-link:focus { color: #ffffff !important; opacity:0.95; }
      .navbar .navbar-nav .nav-link.active { text-decoration: underline; }

      /* Dark mode overrides (toggle `dark-mode` on <body>) */
      body.dark-mode { background: #071025; color: #e6eef8; }
      body.dark-mode .bg-white { background-color: #0f1724 !important; }
      body.dark-mode .bg-gray-50 { background-color: #071025 !important; }
      body.dark-mode .text-gray-800 { color: #e6eef8 !important; }
      body.dark-mode .text-gray-700 { color: #cbd5e1 !important; }
      body.dark-mode .text-gray-600 { color: #94a3b8 !important; }
      body.dark-mode .table th, body.dark-mode .table thead { background-color: #0b1220 !important; color: #e6eef8 !important; }
      body.dark-mode .btn-primary { background-color: #2563eb !important; border-color: #2563eb !important; }
      body.dark-mode .navbar { background: linear-gradient(90deg,#041022,#071028) !important; }
      /* Static header */
      .navbar{
        position: relative;
        z-index: 10;
        background: rgba(0,0,0,0.8) !important;
        transition: background-color .22s ease, box-shadow .18s ease;
        min-height: 64px;
      }
      .navbar:hover{ box-shadow: 0 8px 24px rgba(2,6,23,0.12); }
      /* scroll blur removed */
      /* make nav links highlight across the full header on hover */
      .navbar .nav-link {
        position: relative;
        padding: .5rem 1rem;
        transition: color .14s ease, background .14s ease, transform .14s ease;
        cursor: pointer;
      }
      .navbar .nav-link::after{
        content: '';
        position: absolute;
        left:12px;
        right:12px;
        bottom:8px;
        height:3px;
        border-radius:3px;
        background: rgba(99,102,241,0.0);
        transform-origin: left center;
        transform: scaleX(0);
        transition: transform .28s cubic-bezier(.2,.9,.3,1), background .18s ease;
      }
      .navbar .nav-link:hover{
        background: rgba(255,255,255,0.04);
        border-radius:6px;
        transform: translateY(-1px);
        animation: glow 0.5s ease-in-out;
      }
      .navbar .nav-link:hover::after{ background: rgba(0,191,255,0.18); transform: scaleX(1); }
      @keyframes glow {
        0% { box-shadow: 0 0 5px rgba(0,191,255,0.0); }
        50% { box-shadow: 0 0 10px rgba(0,191,255,0.3); }
        100% { box-shadow: 0 0 5px rgba(0,191,255,0.0); }
      }
      /* animated underline when clicked - will be toggled via JS */
      .navbar .nav-link.underline-active::after{ background: rgba(99,102,241,0.28); transform: scaleX(1); }
      /* remove inline visual clutter: ensure nav links are spaced and smooth */
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg animated-header" data-bs-theme="dark">
      <div class="container-fluid">
        <a class="navbar-brand" href="{% url 'todolist' %}">
          <img src="{% static 'image/list_icon.webp' %}" alt="Todo list app" height="50px" width="50px">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
          <div class="navbar-nav">
            <a class="nav-link" href="{% url 'homepage' %}">Home</a>
            <a class="nav-link" href="{% url 'todolist' %}">Todo list</a>
            <a class="nav-link" href="{% url 'contact' %}">Contact</a>
            <a class="nav-link" href="{% url 'about' %}">About</a>
          </div>
          <div class="d-flex align-items-center ms-auto">
            {% if user.is_authenticated %}
              <span class="text-light me-2">Welcome, {{ user.username }}!</span>
              <form method="post" action="{% url 'logout' %}" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-outline-light btn-sm me-2">Logout</button>
              </form>
            {% else %}
              <a href="{% url 'login' %}" class="btn btn-outline-light btn-sm me-2">Login</a>
            {% endif %}
            <!-- Theme toggle -->
            <button id="theme-toggle" class="btn btn-sm btn-light ms-3" title="Toggle dark/light">
              <svg id="theme-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle></svg>
            </button>
          </div>
          </div>
        </div>
      </div>
    </nav>

    <main id="main-container" class="container" style="padding-top:20px; padding-bottom: 80px;">
      {% if messages %}
        <div class="mt-3">
          {% for message in messages %}
            <div class="alert {% if message.tags %}alert-{{ message.tags }}{% else %}alert-success{% endif %}" role="alert" style="margin-bottom:16px;">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}

      {% block content %}{% endblock content %}
    </main>

    <!-- Footer -->
    <footer class="bg-dark text-light py-4" style="position: fixed; bottom: 0; left: 0; right: 0; z-index: 50;">
      <div class="container">
        <div class="row">
          <div class="col-md-6">
            <h5>TaskMaster</h5>
            <p>AI-Powered Task Management for the Modern Professional</p>
          </div>
          <div class="col-md-6 text-md-end">
            <p>&copy; 2024 TaskMaster. All rights reserved.</p>
            <a href="{% url 'about' %}" class="text-light me-3">About</a>
            <a href="{% url 'contact' %}" class="text-light me-3">Contact</a>
            <a href="#" class="text-light">Privacy</a>
          </div>
        </div>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    <script src="{% static 'js/theme.js' %}"></script>
  </body>
</html>
